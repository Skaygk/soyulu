<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SIGMIZA</title>

<style>

body {
  font-family: Arial, sans-serif;
  background: #000;
  color: #9400D3;
  text-align: center;
  margin: 0;
  padding: 15px;
}

.logo-container {
  margin: 15px 0;
}

.logo {
  width: 60%;
  max-width: 280px;
  height: auto;
  animation: latido 1.8s infinite ease-in-out;
}

@keyframes latido {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.12); }
}

a {
  display: inline-block;
  margin: 10px 0 20px;
  color: #b84cff;
  text-decoration: none;
  font-weight: bold;
}


.table-wrapper {
  overflow-x: auto;
}

table {
  width: 100%;
  min-width: 700px;
  max-width: 1000px;
  margin: 0 auto;
  border-collapse: collapse;
  color: #fff;
}

th, td {
  border: 2px solid #9400D3;
  padding: 10px;
}

th {
  background: #120012;
  color: #b84cff;
}

button {
  padding: 8px 14px;
  background: #b84cff;
  border: none;
  font-weight: bold;
  cursor: pointer;
}

button.borrar {
  background: #ff00aa;
  color: #000;
}

button.borrar:hover {
  background: #ff33cc;
}

#modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
}

#modal-box {
  background: #000;
  color: #b84cff;
  border: 2px solid #9400D3;
  width: 90%;
  max-width: 600px;
  margin: 10% auto;
  padding: 20px;
  text-align: left;
}

#cerrar {
  float: right;
  cursor: pointer;
  font-weight: bold;
}

.upload-container {
  margin: 20px auto;
  max-width: 400px;
}

#fileInput {
  width: 100%;
  margin-bottom: 10px;
}

#uploadBtn {
  width: 100%;
  padding: 10px;
  background: #4caf50;
  color: #000;
  border: none;
  font-weight: bold;
  cursor: pointer;
}

#uploadBtn:hover {
  background: #6bdc6b;
}

#uploadStatus a {
  color: #4caf50;
  word-break: break-all;
}

@media (max-width: 768px) {
  body { padding: 10px; }
  .logo { width: 75%; max-width: 220px; }
  table { font-size: 14px; }
  th:nth-child(4), td:nth-child(4) { display: none; }
  button { padding: 10px; font-size: 14px; }
}
</style>
</head>

<body>


<div class="logo-container">
  <img src="recursos/sigma.jpg" alt="SIGMIZA" class="logo">
</div>


<div class="upload-container">
  <input type="file" id="fileInput" accept="image/*,video/*">
  <button id="uploadBtn">Subir archivo</button>
  <p id="uploadStatus"></p>
</div>

<div class="table-wrapper">
  <table>
    <thead>
      <tr>
        <th>Titulo</th>
        <th>Autor</th>
        <th>Usuario</th>
        <th>Contenido</th>
        <th>Fecha</th>
        <th>Ver</th>
        <th>Borrar</th>
      </tr>
    </thead>
    <tbody id="lista"></tbody>
  </table>
</div>


<div id="modal">
  <div id="modal-box">
    <span id="cerrar">X</span>
    <h2 id="m-titulo"></h2>
    <p id="m-autor"></p>
    <pre id="m-contenido"></pre>
    <p id="m-fecha"></p>
  </div>
</div>

<script>
const modal = document.getElementById('modal');
const cerrar = document.getElementById('cerrar');
const mTitulo = document.getElementById('m-titulo');
const mAutor = document.getElementById('m-autor');
const mContenido = document.getElementById('m-contenido');
const mFecha = document.getElementById('m-fecha');

cerrar.onclick = () => modal.style.display = 'none';


const uploadBtn = document.getElementById('uploadBtn');
const fileInput = document.getElementById('fileInput');
const uploadStatus = document.getElementById('uploadStatus');

uploadBtn.onclick = async () => {
  const file = fileInput.files[0];
  if(!file) { uploadStatus.textContent = 'Selecciona un archivo'; return; }
  if(file.size > 10 * 1024 * 1024) { uploadStatus.textContent = 'Archivo supera 10MB'; return; }

  uploadStatus.textContent = 'Subiendo...';

  const formData = new FormData();
  formData.append('file', file);

  try {
    const res = await fetch('/api/uploadFile', { method: 'POST', body: formData });
    const data = await res.json();
    if(data.ok) {
      uploadStatus.innerHTML = `Archivo subido: <a href="${data.url}" target="_blank">${data.url}</a>`;
      fileInput.value = '';
    } else {
      uploadStatus.textContent = 'Error al subir: ' + data.error;
    }
  } catch(e) {
    uploadStatus.textContent = 'Error al subir';
    console.error(e);
  }
};
</script>

</body>
</html>
